1
00:00:08,733 --> 00:00:14,599
那麼，今天要來跟大家分享我們在「みてね」iOS應用中，關於持續進行背景上傳的挑戰

2
00:00:14,900 --> 00:00:17,699
請容我為各位做個簡報

3
00:00:21,600 --> 00:00:23,899
首先自我介紹

4
00:00:24,000 --> 00:00:26,366
我叫佐藤光

5
00:00:27,166 --> 00:00:30,699
目前在株式会社ミクシー(mixi, Inc.) 的「みてね(Mitene)」事業本部裡

6
00:00:30,766 --> 00:00:34,000
負責開發家族相簿APP「みてね」的 iOS 工程師

7
00:00:37,000 --> 00:00:40,299
今天的分享內容會從「什麼是みてね」開始

8
00:00:40,299 --> 00:00:44,500
接著會談到去年我們在「みてね」實作的背景上傳功能

9
00:00:44,500 --> 00:00:52,766
還有去年我們所解決的課題，以及當時採用的解法，最後會談談未來想做的事

10
00:00:52,766 --> 00:00:55,766
以及如何活用 iOS 26 的新功能

11
00:00:59,966 --> 00:01:03,799
首先，什麼是「みてね」呢？

12
00:01:03,966 --> 00:01:07,000
啊，您有在用Mitene，謝謝

13
00:01:08,400 --> 00:01:13,700
這是一款將孩子的照片和影片分享給家人、享受交流樂趣的智慧型手機應用程式

14
00:01:16,299 --> 00:01:19,299
可以免費、無限制地分享照片和影片

15
00:01:22,200 --> 00:01:24,400
在這裡我想問大家一個問題

16
00:01:26,000 --> 00:01:30,400
現在在場的各位中，有多少人正在使用Mitene呢？

17
00:01:30,400 --> 00:01:31,400
麻煩請舉個手

18
00:01:39,900 --> 00:01:41,700
大概20%左右嗎？

19
00:01:41,700 --> 00:01:44,966
不好意思，等一下希望能再聽聽各位的意見

20
00:01:44,966 --> 00:01:46,599
謝謝大家

21
00:01:48,599 --> 00:01:51,799
接下來要談的是......

22
00:01:51,799 --> 00:01:53,900
在 Mitene 這款 App 中

23
00:01:53,966 --> 00:01:56,666
因為是分享照片和影片的應用程式

24
00:01:56,666 --> 00:01:58,700
「上傳」這件事就非常重要

25
00:01:58,700 --> 00:02:02,700
改善上傳體驗，就是我們這次的主題

26
00:02:02,700 --> 00:02:11,300
關於去年我們在「上傳」方面所解決的課題

27
00:02:11,300 --> 00:02:15,366
首先，課題究竟是什麼呢？

28
00:02:15,400 --> 00:02:19,466
那就是在照片影片上傳過程中，如果切換到背景模式

29
00:02:19,466 --> 00:02:23,866
上傳會在 30 分鐘後被中斷，我們遇到了這樣的課題

30
00:02:24,500 --> 00:02:28,900
這就是在 iOS 中被稱為 beginBackgroundTask

31
00:02:28,900 --> 00:02:30,699
我想很多人可能都知道這個

32
00:02:30,699 --> 00:02:32,900
這就是它的限制

33
00:02:32,966 --> 00:02:37,400
所以在 Mitene 上傳就會被中斷

34
00:02:37,400 --> 00:02:42,066
導致在上傳過程中，必須一直開著 app 才行

35
00:02:43,266 --> 00:02:48,066
在 Mitene ，一次上傳大量的照片和影片

36
00:02:48,066 --> 00:02:49,466
是用戶的一種使用傾向

37
00:02:49,466 --> 00:02:53,666
所以很容易因為這個限制而導致上傳中斷

38
00:02:58,599 --> 00:03:00,000
當上傳被中斷的時候

39
00:03:00,066 --> 00:03:02,099
雖然現在這個畫面出現的

40
00:03:02,099 --> 00:03:04,699
出現的條件已經少很多了

41
00:03:04,766 --> 00:03:07,099
就會像這樣，上傳到一半

42
00:03:07,099 --> 00:03:08,900
上傳被中斷了

43
00:03:08,900 --> 00:03:12,699
然後你就得『啊～』一聲，重新打開 app

44
00:03:12,699 --> 00:03:14,599
雖然上傳會從中斷的地方繼續

45
00:03:14,666 --> 00:03:16,766
但就變成得這樣才能繼續

46
00:03:20,800 --> 00:03:26,400
首先，針對這個課題，我們探討了哪些解決方案呢？

47
00:03:26,400 --> 00:03:32,866
第一個方案，在去年算是相當主流的做法

48
00:03:32,900 --> 00:03:38,500
就是考慮使用 BGProcessingTask 作為解決方案

49
00:03:38,566 --> 00:03:43,000
我們也在公司內部舉辦了功能性審查會議

50
00:03:43,000 --> 00:03:47,266
但結論是這個規格和 Mitene 的上傳需求不太適合

51
00:03:47,266 --> 00:03:51,599
不適合的地方，大致就是寫在這裡的這幾點

52
00:03:51,599 --> 00:03:56,166
它會在深夜、充電時，每次大概可以處理約 5 分鐘

53
00:03:56,199 --> 00:03:58,300
每 30 分鐘

54
00:03:58,300 --> 00:04:00,800
雖然是定在大概每 30 分鐘

55
00:04:00,800 --> 00:04:03,400
差不多是這樣運作的

56
00:04:03,400 --> 00:04:05,666
首先，如果在深夜運作的話

57
00:04:05,699 --> 00:04:07,800
當上傳完成時

58
00:04:07,866 --> 00:04:10,599
Mitene 會發送一個完成通知

59
00:04:10,599 --> 00:04:11,900
那個通知就會在深夜被發送出去

60
00:04:11,900 --> 00:04:16,500
這樣家人可能就會以為你「怎麼這麼晚還沒睡」之類的

61
00:04:16,566 --> 00:04:18,300
我們有這樣的顧慮

62
00:04:18,300 --> 00:04:21,766
所以最後沒有採用這個方案

63
00:04:22,600 --> 00:04:26,300
ok

64
00:04:26,566 --> 00:04:28,699
解決方案二

65
00:04:28,699 --> 00:04:30,500
我們也姑且評估了「Live Activity」

66
00:04:30,566 --> 00:04:34,566
想說「這個說不定也行」

67
00:04:34,899 --> 00:04:37,466
但因為它也是 Extension 的一種

68
00:04:37,466 --> 00:04:42,000
所以沒辦法讓 app 端的處理程序繼續執行

69
00:04:46,000 --> 00:04:49,000
第三個解決方案

70
00:04:49,000 --> 00:04:51,199
我們最後採用了這個

71
00:04:51,199 --> 00:04:55,466
就是用「Picture In Picture」製作了原型

72
00:04:55,500 --> 00:04:58,199
原型大概是做成這個樣子

73
00:04:58,199 --> 00:05:00,766
在這個 UI 上，Picture In Picture 的

74
00:05:00,766 --> 00:05:03,800
會跑出像這樣影片的操作按鈕

75
00:05:03,866 --> 00:05:07,366
但透過這個方式，背景上傳

76
00:05:07,366 --> 00:05:12,500
就能不受剛才提到的30秒限制，得以繼續執行

77
00:05:12,500 --> 00:05:13,866
所以我們採用了這個方案

78
00:05:19,000 --> 00:05:22,566
接下來是我們實際發布的功能

79
00:05:23,800 --> 00:05:25,866
這個有在播放嗎？

80
00:05:25,899 --> 00:05:30,500
有在動嗎？咦？沒在動？

81
00:05:36,199 --> 00:05:38,300
哎呀，影片完全不會動

82
00:05:38,366 --> 00:05:40,399
我之後會再上傳簡報資料

83
00:05:40,399 --> 00:05:43,500
到時候再請大家觀看

84
00:05:45,300 --> 00:05:47,966
實際上開始上傳時

85
00:05:48,766 --> 00:05:50,699
這個...會動...看來真的不會動呢，抱歉

86
00:05:52,666 --> 00:05:57,199
會像這樣顯示 Picture In Picture 的畫面

87
00:05:57,300 --> 00:06:02,466
在上傳過程中切換到背景時

88
00:06:02,466 --> 00:06:06,600
藉由將 UIView 以 Picture In Picture 顯示

89
00:06:06,666 --> 00:06:11,500
我們發布了這個能讓上傳繼續進行的功能

90
00:06:11,500 --> 00:06:18,266
這個功能是 Mitene Premium Pro 的限定功能

91
00:06:18,266 --> 00:06:22,300
我們 mixi 也已經提出了專利申請

92
00:06:22,300 --> 00:06:26,266
這裡我還想再問一個問題

93
00:06:26,266 --> 00:06:31,166
在 Mitene 上傳過程中切換到背景時

94
00:06:31,199 --> 00:06:34,699
這裡會用 Picture In Picture 顯示一個畫面

95
00:06:34,699 --> 00:06:38,366
有多少人注意到這件事了呢？

96
00:06:38,399 --> 00:06:41,000
可以的話請舉個手

97
00:06:42,500 --> 00:06:45,300
看來是沒有人呢

98
00:06:46,800 --> 00:06:51,199
順帶一提，剛剛使用 Mitene 的用戶

99
00:06:51,199 --> 00:06:53,866
我記得有幾位

100
00:06:53,866 --> 00:06:56,399
請問有加入 Mitene Premium 的用戶

101
00:06:56,466 --> 00:06:59,300
大概有多少位呢？

102
00:07:01,800 --> 00:07:03,300
2 位

103
00:07:03,300 --> 00:07:05,100
謝謝

104
00:07:05,300 --> 00:07:07,666
我們還有一個更進階的方案叫 Premium Pro

105
00:07:07,666 --> 00:07:08,966
有加入那個方案的......

106
00:07:08,966 --> 00:07:13,300
您是 Premium 方案是嗎？

107
00:07:13,300 --> 00:07:15,466
原來如此，不好意思，謝謝您

108
00:07:16,600 --> 00:07:19,699
Premium Pro 是比較高階的方案，一個月大概1000日圓

109
00:07:19,766 --> 00:07:22,600
如果有加入那個方案，就會出現

110
00:07:25,399 --> 00:07:30,500
接下來談談這個解決方案誕生的背景

111
00:07:31,766 --> 00:07:34,000
當時在討論 BGProcessingTask 方案時

112
00:07:34,000 --> 00:07:38,300
我們決定要在公司內部進行功能性審查

113
00:07:38,300 --> 00:07:43,199
在那之前，大家在討論要怎麼請大家協助審查

114
00:07:43,199 --> 00:07:47,899
大概 4 個人左右，在討論時冒出的一個點子

115
00:07:47,899 --> 00:07:51,500
那時候聊到 Pictuire In Picture

116
00:07:51,566 --> 00:07:54,199
「那個是不是能讓 app 的處理繼續執行啊？」

117
00:07:54,199 --> 00:07:56,800
「好像可以耶」，就聊了這樣的話題

118
00:07:56,800 --> 00:08:01,466
於是我們就試著做了一下，把它加進去

119
00:08:01,466 --> 00:08:04,000
結果發現「喔！這突破背景限制了耶！」

120
00:08:04,000 --> 00:08:05,066
就變成了那種感覺

121
00:08:05,066 --> 00:08:07,899
就是這樣

122
00:08:07,899 --> 00:08:09,100
在討論的過程中

123
00:08:09,166 --> 00:08:13,466
我們也聊到，如果 Picture In Picture 能維持 app 的處理

124
00:08:13,466 --> 00:08:17,199
那我們是不是可以播放一個適合的、像樣的本地影片

125
00:08:17,199 --> 00:08:21,500
一邊播放一邊繼續上傳，「這樣是不是也行得通啊？」

126
00:08:21,500 --> 00:08:25,366
當時也聊了這樣的話題，還滿熱烈的

127
00:08:27,966 --> 00:08:32,899
關於它的機制，大致上是像這個樣子

128
00:08:32,899 --> 00:08:37,200
我們將 UIView 轉換成影片影格

129
00:08:37,200 --> 00:08:40,366
然後用 Picture In Picture 顯示出來

130
00:08:40,366 --> 00:08:42,500
我們做的就是這樣的事情

131
00:08:42,500 --> 00:08:49,000
之所以要轉換成影片影格

132
00:08:49,066 --> 00:08:52,066
是因為 Picture In Picture 能夠顯示的

133
00:08:52,066 --> 00:08:55,700
就是影片影格，所以才需要轉換

134
00:08:58,366 --> 00:09:05,299
這個方案，我們大量參考了像這樣的參考資料

135
00:09:07,666 --> 00:09:10,200
我腦中原本就有印象

136
00:09:10,200 --> 00:09:11,899
「啊，本來就有這種東西」

137
00:09:11,899 --> 00:09:14,500
大概就是那樣才做出來的

138
00:09:17,700 --> 00:09:22,866
接下來，要談談困難的地方

139
00:09:26,200 --> 00:09:28,200
大致上有三個

140
00:09:29,700 --> 00:09:32,166
要讓 UIView 顯示在 Picture In Picture

141
00:09:32,166 --> 00:09:34,666
實作本身就很困難

142
00:09:34,700 --> 00:09:36,500
再來是

143
00:09:36,500 --> 00:09:39,799
切換到背景時自動啟動 Picture in Picture

144
00:09:40,000 --> 00:09:43,666
還有 Picture In Picture 的 UI 顯示和限制

145
00:09:43,666 --> 00:09:46,200
這些地方都相當困難

146
00:09:50,899 --> 00:09:56,200
我會來稍微深入探討一下這些困難的地方

147
00:09:56,200 --> 00:10:01,966
首先，是關於將 UIView 顯示在 Picture In Picture 的實作

148
00:10:02,000 --> 00:10:07,766
這個嘛，首先是實作本身就很困難

149
00:10:08,200 --> 00:10:09,866
這個「轉換成影片影格」的部分

150
00:10:09,866 --> 00:10:11,466
雖然有很多參考資料

151
00:10:11,500 --> 00:10:14,700
但實際做起來還是有很多困難點

152
00:10:14,766 --> 00:10:20,366
另外，要啟用 Picture In Picture 是有條件的

153
00:10:20,366 --> 00:10:24,100
像是這些背景模式的條件

154
00:10:24,700 --> 00:10:25,600
是背景模式的設定才對

155
00:10:25,666 --> 00:10:27,566
的確認

156
00:10:27,566 --> 00:10:34,766
或是需要設定 `AVAudioSession` 的 category 為 playback 之類的

157
00:10:34,799 --> 00:10:36,899
這些都很不容易注意到

158
00:10:36,966 --> 00:10:39,399
雖然參考資料上好像有寫

159
00:10:39,399 --> 00:10:41,700
但那些地方都很困難

160
00:10:41,766 --> 00:10:44,799
還有，即使 Picture In Picture 沒有啟動

161
00:10:44,799 --> 00:10:47,200
也經常不會回傳錯誤

162
00:10:47,200 --> 00:10:49,299
導致『怎麼沒有啟動』的狀況

163
00:10:49,299 --> 00:10:52,100
就變成了那種感覺

164
00:10:54,200 --> 00:10:57,700
為了幫自己回想一下實作方式

165
00:10:57,700 --> 00:11:01,700
我用最精簡的程式碼公開了範例

166
00:11:01,700 --> 00:11:07,000
有興趣的人之後可以看看

167
00:11:10,299 --> 00:11:14,100
接下來是實作困難點的一個例子

168
00:11:15,466 --> 00:11:17,000
這個紅框的附近

169
00:11:17,166 --> 00:11:18,299
像是「in Picture in Picture」

170
00:11:18,299 --> 00:11:19,466
這個字串

171
00:11:20,399 --> 00:11:21,799
並不是我們用 Label 顯示的

172
00:11:21,799 --> 00:11:23,966
它是會自動跑出來的

173
00:11:23,966 --> 00:11:25,600
有像這樣的狀況

174
00:11:25,600 --> 00:11:28,366
所以我們得把它設成透明讓它看不見

175
00:11:28,399 --> 00:11:30,299
我們下了一些這樣的工夫

176
00:11:33,500 --> 00:11:36,000
困難點的第二個

177
00:11:38,166 --> 00:11:39,600
自動...切換到背景時自動...

178
00:11:39,600 --> 00:11:41,399
啟動 Pictuire In Picture

179
00:11:43,566 --> 00:11:45,299
這個就是

180
00:11:46,000 --> 00:11:50,000
可以自動開始PiP的屬性

181
00:11:50,366 --> 00:11:51,799
雖然有這樣的屬性

182
00:11:51,799 --> 00:11:54,566
但它運作的條件

183
00:11:54,566 --> 00:11:57,399
並沒有特別寫在文件上

184
00:11:57,399 --> 00:11:59,000
也許仔細看的話有寫吧

185
00:11:59,000 --> 00:12:03,299
但我們找不到，所以很困難

186
00:12:04,066 --> 00:12:05,166
條件就是

187
00:12:05,600 --> 00:12:07,500
照著念的話

188
00:12:07,600 --> 00:12:09,899
像是 `AVSampleBufferDisplayLayer`

189
00:12:09,899 --> 00:12:12,399
就是剛才的影片影格

190
00:12:12,399 --> 00:12:14,266
它必須已經被繪製出來

191
00:12:14,266 --> 00:12:16,066
必須事先被繪製出來

192
00:12:16,066 --> 00:12:18,399
或是在切換到背景之前

193
00:12:18,399 --> 00:12:21,100
`PictuireInPictureController` 必須已被初始化

194
00:12:21,700 --> 00:12:22,200
之類的

195
00:12:22,200 --> 00:12:23,799
還有 delegate 的

196
00:12:23,866 --> 00:12:25,799
這個 method 的布林值

197
00:12:25,799 --> 00:12:26,866
必須是 false 之類的

198
00:12:27,700 --> 00:12:30,000
就是有很多這種看不見的條件

199
00:12:30,000 --> 00:12:31,600
就是這樣

200
00:12:37,399 --> 00:12:40,000
Delegate 的程式碼大概是長這樣

201
00:12:40,000 --> 00:12:42,899
大家現在看到的是我們正在用的版本

202
00:12:42,899 --> 00:12:45,200
大概就是像這個樣子

203
00:12:48,466 --> 00:12:49,866
還有，為了在切換到背景時自動

204
00:12:49,866 --> 00:12:52,200
啟動 Picture In Picture

205
00:12:52,200 --> 00:12:54,066
我們的做法是

206
00:12:54,100 --> 00:12:58,100
在 root window 上將 Picture In Picture 的 UIView

207
00:12:58,100 --> 00:13:01,600
用這種方式，以看不見的形式加上去

208
00:13:01,600 --> 00:13:07,500
會這麼做，是為了讓App在上傳過程中，無論從哪個畫面

209
00:13:08,100 --> 00:13:11,299
切換到背景時，都能啟動 ピクチャーインピクチャー

210
00:13:11,299 --> 00:13:15,600
為了做到這點，我們才用了這樣的架構

211
00:13:19,600 --> 00:13:21,200
第三點

212
00:13:21,299 --> 00:13:25,000
關於 Picture In Picture 的 UI 顯示與限制

213
00:13:27,500 --> 00:13:29,200
那個...我突然覺得好緊張

214
00:13:29,200 --> 00:13:31,866
可以讓我深呼吸一下嗎？

215
00:13:38,100 --> 00:13:40,366
不好意思

216
00:13:40,566 --> 00:13:42,399
還剩幾分鐘...12分鐘

217
00:13:45,899 --> 00:13:47,100
好，我沒問題了

218
00:13:49,566 --> 00:13:51,600
謝謝

219
00:13:51,700 --> 00:13:55,266
然後，Pictuire In Picutre 的 UI 是這樣

220
00:13:55,766 --> 00:13:59,166
會慢慢地顯示出來

221
00:14:01,100 --> 00:14:03,299
會顯示像這樣的 UI

222
00:14:03,299 --> 00:14:09,000
然後，那個...

223
00:14:09,600 --> 00:14:11,299
對

224
00:14:17,899 --> 00:14:22,600
這個 Picture In Picture 畢竟是為影片設計的模組

225
00:14:22,600 --> 00:14:26,100
所以會跑出像是播放按鈕或暫停按鈕

226
00:14:26,166 --> 00:14:29,299
結果是現在也還是會顯示

227
00:14:29,299 --> 00:14:31,600
現在真的就是這個樣子

228
00:14:31,600 --> 00:14:33,299
左邊有關閉按鈕

229
00:14:33,366 --> 00:14:35,799
右邊有返回App的按鈕

230
00:14:35,799 --> 00:14:38,066
中間有暫停按鈕

231
00:14:38,066 --> 00:14:40,899
還有一個進度條

232
00:14:43,299 --> 00:14:45,299
這部分我們基本上就是維持預設的樣子

233
00:14:45,299 --> 00:14:47,500
雖然可以為暫停按鈕編寫處理邏輯

234
00:14:47,500 --> 00:14:49,700
但我們都沒處理

235
00:14:51,166 --> 00:14:55,700
關於這個行為，我們公司內部也討論過

236
00:14:55,700 --> 00:14:58,399
是否要採取什麼對策

237
00:14:58,399 --> 00:15:01,200
但結論是「這應該沒什麼關係吧？」

238
00:15:01,200 --> 00:15:02,866
「畢竟也不是一直都顯示著」

239
00:15:02,866 --> 00:15:04,299
因為這樣

240
00:15:04,299 --> 00:15:09,500
我們發布時就真的什麼處理都沒寫

241
00:15:09,500 --> 00:15:13,366
到目前為止，也沒收到用戶反應說「這個很難懂」

242
00:15:13,399 --> 00:15:17,600
之類的回饋

243
00:15:21,200 --> 00:15:23,899
接下來還是關於限制的部分

244
00:15:23,899 --> 00:15:27,666
有一個會變全黑的問題

245
00:15:28,100 --> 00:15:32,000
就是從裝置鎖定狀態解除時

246
00:15:32,000 --> 00:15:36,799
PIP 的畫面有時會變全黑

247
00:15:38,200 --> 00:15:43,566
為了盡可能避免這個現象

248
00:15:43,600 --> 00:15:48,299
我們對 PiP 的畫面更新

249
00:15:48,299 --> 00:15:56,799
下了一點工夫，讓它最長、最長也是 1 分鐘就更新一次顯示

250
00:16:00,466 --> 00:16:02,866
還是關於限制的部分

251
00:16:03,700 --> 00:16:05,500
對，這是一段影片

252
00:16:05,500 --> 00:16:07,966
但看來影片是播不出來了

253
00:16:07,966 --> 00:16:12,166
等我之後上傳簡報資料時

254
00:16:12,200 --> 00:16:13,899
會再放進去

255
00:16:14,966 --> 00:16:16,366
就如同這裡寫的

256
00:16:16,366 --> 00:16:19,466
如果在其他 app 開始了 Picture In Picture

257
00:16:19,500 --> 00:16:21,000
因為 Picture In Picture

258
00:16:21,000 --> 00:16:24,799
在一台裝置上只能播放一個

259
00:16:26,000 --> 00:16:27,866
就會被其他App覆蓋過去

260
00:16:27,866 --> 00:16:29,866
導致上傳停止

261
00:16:29,866 --> 00:16:31,600
這是一個限制

262
00:16:32,166 --> 00:16:34,700
例如，Mitene 正在上傳時

263
00:16:34,700 --> 00:16:37,566
你跑去看了 YouTube

264
00:16:37,566 --> 00:16:40,299
看 YouTube 是沒問題的

265
00:16:40,299 --> 00:16:44,200
但看完後，YouTube 如果有加入 Premium 方案

266
00:16:44,200 --> 00:16:45,899
我記得好像是 Premium 方案沒錯

267
00:16:45,899 --> 00:16:47,000
切到背景時

268
00:16:47,066 --> 00:16:50,100
它會啟動 Picture In Picture

269
00:16:51,366 --> 00:16:54,200
一旦它啟動了，我們的 PiP 就會被搶走

270
00:16:54,600 --> 00:16:56,600
上傳就會因此結束

271
00:16:59,766 --> 00:17:01,799
啊，出來了

272
00:17:03,100 --> 00:17:05,500
但還是沒辦法播放

273
00:17:06,966 --> 00:17:12,299
接著，是 Picture In Picture 背景上傳無法解決的問題

274
00:17:15,166 --> 00:17:18,299
無法解決的問題是

275
00:17:19,666 --> 00:17:22,500
在裝置鎖定時的上傳

276
00:17:25,000 --> 00:17:28,000
Picture In Picture 本身在裝置鎖定時

277
00:17:28,000 --> 00:17:30,400
並不會被強制終止…

278
00:17:31,166 --> 00:17:35,700
但在那個時間點... 應該說，這依裝置而定

279
00:17:35,700 --> 00:17:41,799
鎖定後，可能過一段時間，也可能馬上

280
00:17:41,799 --> 00:17:44,866
處理就會暫時停止

281
00:17:44,866 --> 00:17:48,166
記憶體的狀態會被保留

282
00:17:48,200 --> 00:17:53,700
所以解除鎖定時，背景處理就會恢復執行

283
00:17:53,700 --> 00:17:57,799
但上傳的連線會因為逾時而中斷

284
00:18:02,366 --> 00:18:04,900
接下來是關於 Apple 審查的對策

285
00:18:04,966 --> 00:18:07,700
在審查對策方面

286
00:18:07,766 --> 00:18:14,266
其實結果是很普通地、沒什麼問題就通過了

287
00:18:14,766 --> 00:18:18,200
那為什麼我們還要特地準備審查對策呢？

288
00:18:18,200 --> 00:18:20,400
是因為 Picture In Picture 的啟動

289
00:18:20,466 --> 00:18:23,500
必須由用戶操作來啟動

290
00:18:23,500 --> 00:18:26,500
文件上有這樣的記載

291
00:18:27,066 --> 00:18:29,366
我們不太確定

292
00:18:29,366 --> 00:18:32,466
「切換到背景」這個動作

293
00:18:32,500 --> 00:18:35,400
到底算不算是「用戶操作」

294
00:18:35,400 --> 00:18:37,299
因為覺得可能不太好說

295
00:18:37,366 --> 00:18:42,366
所以想說保險起見，問問看這樣可不可以

296
00:18:42,366 --> 00:18:44,400
就送審了

297
00:18:45,700 --> 00:18:47,099
結果沒什麼問題就通過了

298
00:18:48,966 --> 00:18:53,066
送審的方式，我想這大家應該很常用

299
00:18:54,366 --> 00:18:57,466
就是在 App Store Connect 的「App Review 相關資訊」

300
00:18:57,466 --> 00:18:58,099
這裡

301
00:18:58,099 --> 00:19:01,700
在這個紅框的地方，作為備註

302
00:19:01,700 --> 00:19:03,500
寫下功能的詳細說明

303
00:19:03,500 --> 00:19:08,700
然後附上影片送出

304
00:19:11,000 --> 00:19:12,299
Apple 也沒有對這個功能回覆什麼感想

305
00:19:12,366 --> 00:19:16,366
就很普通地被核准了

306
00:19:19,466 --> 00:19:20,266
範例程式碼

307
00:19:20,466 --> 00:19:22,299
就是剛才那個

308
00:19:22,366 --> 00:19:27,599
這個我大概沒時間介紹了

309
00:19:27,599 --> 00:19:31,400
我就簡單說明一下

310
00:19:33,099 --> 00:19:35,566
用 UIView 顯示 PiP

311
00:19:35,566 --> 00:19:41,299
並且讓 PiP 在切換到背景時自動啟動

312
00:19:41,366 --> 00:19:43,400
把這部分用最精簡的程式碼

313
00:19:43,400 --> 00:19:47,266
我記得大概用 200 還 300 行左右寫出來了

314
00:19:47,266 --> 00:19:50,566
抱歉，影片還是不能播

315
00:19:51,566 --> 00:19:57,466
等我上傳簡報後，有興趣的人再麻煩看一下

316
00:20:03,299 --> 00:20:06,799
接下來是未來想做的事

317
00:20:07,666 --> 00:20:10,566
活用 iOS 26 SDK

318
00:20:10,599 --> 00:20:12,700
Xcode 26

319
00:20:13,500 --> 00:20:17,000
基本上我們是用 RC 版進行了驗證

320
00:20:17,000 --> 00:20:19,099
還剩下...

321
00:20:19,099 --> 00:20:21,166
還有 21 分鐘

322
00:20:26,599 --> 00:20:30,599
作為 iOS 26 和 Xcode 26 的新功能

323
00:20:30,599 --> 00:20:36,299
有一個可以在前景啟動的 BGContinuedProcessingTask

324
00:20:36,299 --> 00:20:39,666
在 WWDC 上發表了

325
00:20:40,266 --> 00:20:44,366
這個功能和我們用 Picture in Picture 做的上傳非常相似

326
00:20:45,000 --> 00:20:46,200
「這是不是能用啊？」

327
00:20:46,200 --> 00:20:48,200
「感覺可以喔？」

328
00:20:48,200 --> 00:20:49,966
公司裡

329
00:20:49,966 --> 00:20:53,366
有很懂 iOS 的人

330
00:20:53,366 --> 00:20:55,866
他就去做了調查

331
00:20:55,866 --> 00:20:58,299
如果我也有認真看 WWDC 的話

332
00:20:58,299 --> 00:20:59,400
或許我也會注意到

333
00:20:59,466 --> 00:21:02,299
但我也是被提醒了才發現

334
00:21:02,299 --> 00:21:02,966
所以就覺得

335
00:21:02,966 --> 00:21:05,666
「啊，我真是」

336
00:21:05,700 --> 00:21:08,299
「學習不足啊」

337
00:21:08,299 --> 00:21:09,299
但還好他提醒了我

338
00:21:09,366 --> 00:21:11,200
我們才能夠去調查

339
00:21:14,500 --> 00:21:16,700
至於它是什麼樣的東西呢？

340
00:21:17,366 --> 00:21:21,400
它是在前景透過按鈕點擊之類的動作來啟動

341
00:21:21,466 --> 00:21:28,900
有需要的話，也會顯示在前景

342
00:21:28,900 --> 00:21:32,166
進度會用 Live Activity 顯示

343
00:21:32,166 --> 00:21:35,000
用戶也可以隨時取消

344
00:21:35,000 --> 00:21:39,599
按下右邊的按鈕就能取消

345
00:21:42,166 --> 00:21:44,099
它的優點是

346
00:21:44,099 --> 00:21:49,000
剛才提到的裝置鎖定時無法上傳的問題

347
00:21:49,066 --> 00:21:50,966
這個問題能被解決

348
00:21:50,966 --> 00:21:51,900
是個很大的優點

349
00:21:51,900 --> 00:21:54,400
對 Mitene 來說是個非常大的優點

350
00:21:55,799 --> 00:21:57,400
缺點方面

351
00:21:57,400 --> 00:22:01,366
我等一下會再說明

352
00:22:01,366 --> 00:22:04,400
其實沒有什麼太大的缺點

353
00:22:04,400 --> 00:22:06,266
就是有一些限制

354
00:22:06,266 --> 00:22:10,066
UI 方面也或多或少會受到一些限制

355
00:22:10,099 --> 00:22:14,099
勉強要說的話，大概就是這些吧

356
00:22:14,099 --> 00:22:17,599
好，關於 UI

357
00:22:17,599 --> 00:22:21,599
這張投影片大概全都是影片

358
00:22:21,599 --> 00:22:24,599
我猜是看不了了

359
00:22:24,599 --> 00:22:26,599
啊，勉強能看到一點。完成的時候

360
00:22:26,599 --> 00:22:31,966
其實右邊會出現一個 Checkwork 表示完成

361
00:22:41,400 --> 00:22:42,700
當它縮到狀態列時

362
00:22:42,700 --> 00:22:47,500
會依裝置而定，但就像這樣變成藍色的

363
00:22:47,500 --> 00:22:52,200
裝置鎖定時也是像這樣

364
00:22:52,200 --> 00:22:55,299
會顯示 Live Activity

365
00:22:55,299 --> 00:22:59,200
這時候一樣可以進行取消之類的動作

366
00:23:03,500 --> 00:23:05,700
可以自訂的部分

367
00:23:05,766 --> 00:23:08,466
是標題和副標題

368
00:23:08,466 --> 00:23:11,566
可以放入字串

369
00:23:11,799 --> 00:23:13,966
左側會自動顯示 app icon

370
00:23:14,299 --> 00:23:19,099
右側則是顯示進度

371
00:23:21,400 --> 00:23:25,400
關於進度顯示的部分

372
00:23:25,400 --> 00:23:29,200
透過 completedUnitedCount 這個變數

373
00:23:29,200 --> 00:23:31,966
和 totalUnitedCount 這個變數

374
00:23:31,966 --> 00:23:40,266
去指定完成數和總數，就能做出來

375
00:23:41,599 --> 00:23:44,200
當完成數達到總數時

376
00:23:44,200 --> 00:23:45,900
就會出現這個打勾符號

377
00:23:45,900 --> 00:23:48,500
規格就是這樣

378
00:23:52,566 --> 00:23:54,266
還有，這是我做了才發現的

379
00:23:54,266 --> 00:23:59,400
文字顏色和背景顏色好像沒辦法指定

380
00:23:59,400 --> 00:24:04,333
我覺得在某些情況下可能會很難閱讀

381
00:24:06,500 --> 00:24:08,200
這就是剛才說的

382
00:24:08,200 --> 00:24:09,566
縮到狀態列的時候

383
00:24:09,599 --> 00:24:13,766
這個，上面是 iPhone SE 3

384
00:24:14,466 --> 00:24:22,266
SE3 的顯示；下面是 iPhone 16e 的顯示

385
00:24:23,566 --> 00:24:27,666
關於實作方法

386
00:24:30,466 --> 00:24:32,166
背景模式的指定...

387
00:24:32,166 --> 00:24:33,400
雖然是背景任務

388
00:24:33,400 --> 00:24:37,700
但它是不需要指定背景模式的

389
00:24:37,700 --> 00:24:40,366
一般在做背景模式時

390
00:24:40,366 --> 00:24:45,500
不是會在 Xcode 這裡追加 Capability 然後打勾嗎？

391
00:24:45,566 --> 00:24:46,566
Xcode 好像有這個吧

392
00:24:46,566 --> 00:24:47,566
這個就不需要了

393
00:24:47,599 --> 00:24:50,700
是連 "Background Modes" 本身都不需要

394
00:24:51,200 --> 00:24:52,900
它就是這樣設計的

395
00:24:55,266 --> 00:24:58,900
plist 裡面需要填入 Background Task 的 ID

396
00:24:58,900 --> 00:25:01,700
必須把這個加進去

397
00:25:01,700 --> 00:25:05,099
我想這點和其他的 Background Task 是一樣的

398
00:25:07,700 --> 00:25:11,766
程式碼大致上是像這個樣子

399
00:25:12,166 --> 00:25:13,099
現在幾分鐘了？

400
00:25:13,166 --> 00:25:14,099
14分

401
00:25:17,799 --> 00:25:19,400
我稍微解說一下

402
00:25:19,400 --> 00:25:21,200
這個 `register`

403
00:25:21,266 --> 00:25:24,166
`BGTaskScheduler.register`

404
00:25:24,166 --> 00:25:27,166
這個在其他的 background task

405
00:25:27,166 --> 00:25:30,700
要註冊處理程序時，我想也是用一樣的東西

406
00:25:30,766 --> 00:25:32,466
執行這個之後

407
00:25:32,466 --> 00:25:35,966
在這個 closure 裡面，會在要被處理時被呼叫

408
00:25:35,966 --> 00:25:41,066
它會在 main thread 以外的 background thread 執行

409
00:25:41,066 --> 00:25:47,500
之後再把它 casting 成 `BGProcessingTask`

410
00:25:47,566 --> 00:25:49,500
`expirationHandler` 這邊

411
00:25:49,500 --> 00:25:52,400
這是在按下取消按鈕時

412
00:25:52,400 --> 00:25:56,266
或是系統因為某些資源限制

413
00:25:56,266 --> 00:25:58,166
自動取消時也會被呼叫

414
00:25:58,166 --> 00:26:02,000
我們要寫一個像那樣的 handler

415
00:26:02,000 --> 00:26:07,400
決定進度的值和管理方式

416
00:26:07,400 --> 00:26:14,166
把進度的值 +1 之類的，慢慢地 increment 上去

417
00:26:14,166 --> 00:26:19,299
然後更新標題或副標題

418
00:26:19,299 --> 00:26:24,900
最後是 `setTaskCompleted`

419
00:26:24,900 --> 00:26:28,200
在這裡傳入一個布林值，表示成功或失敗

420
00:26:28,266 --> 00:26:31,966
然後就結束了

421
00:26:31,966 --> 00:26:33,466
大概是像這樣

422
00:26:33,466 --> 00:26:39,099
關於設定背景執行的請求

423
00:26:39,166 --> 00:26:41,200
是像這個樣子

424
00:26:41,200 --> 00:26:43,666
建立一個 request

425
00:26:43,666 --> 00:26:47,200
建立 request 時也可以決定標題和副標題

426
00:26:47,200 --> 00:26:52,599
有兩種 strategy 可以指定

427
00:26:52,599 --> 00:26:54,566
指定那個

428
00:26:54,566 --> 00:27:00,466
如果要用 GPU 的話，就要指定說「我要用 GPU」

429
00:27:00,466 --> 00:27:01,466
做那樣的指定

430
00:27:01,466 --> 00:27:04,766
然後 `BGTaskScheduler.submit` 出去

431
00:27:04,799 --> 00:27:06,900
就是這樣的感覺

432
00:27:06,900 --> 00:27:11,900
關於「使用 GPU」這部分

433
00:27:11,900 --> 00:27:13,500
像這樣子

434
00:27:13,500 --> 00:27:19,299
必須要在 Capability 裡面指定

435
00:27:20,299 --> 00:27:23,966
然後，驗證之後發現了一些事情

436
00:27:24,000 --> 00:27:27,266
我想跟大家分享一下

437
00:27:29,666 --> 00:27:32,099
首先是...

438
00:27:34,400 --> 00:27:38,666
這個進度的值，基本上為了讓它接近總數

439
00:27:38,700 --> 00:27:40,066
會去做 increment

440
00:27:40,066 --> 00:27:43,400
就是會慢慢增加它

441
00:27:43,466 --> 00:27:46,599
如果這個值一定時間內沒有變化的話

442
00:27:46,599 --> 00:27:49,366
background task 本身會被停止

443
00:27:49,366 --> 00:27:52,799
我們確認到了這個現象

444
00:27:52,799 --> 00:27:56,266
從這張圖也可以看出來

445
00:27:56,299 --> 00:28:01,299
它停止的時間，並不是固定的

446
00:28:01,366 --> 00:28:03,666
以我驗證的感覺是

447
00:28:03,666 --> 00:28:08,200
它最少會等個 30 秒左右

448
00:28:09,266 --> 00:28:11,366
但大概過了 30 秒

449
00:28:11,400 --> 00:28:13,466
有時 30 秒，有時 70 秒

450
00:28:13,466 --> 00:28:15,299
像這個例子就是 70 秒

451
00:28:15,299 --> 00:28:18,900
一旦沒有變化，系統就會自動把它停掉

452
00:28:18,966 --> 00:28:22,000
它就是這樣的行為

453
00:28:22,299 --> 00:28:26,966
有些處理程序可能是那種不知道進度的

454
00:28:26,966 --> 00:28:29,666
「雖然不知道進度，但還在跑」的這種

455
00:28:29,666 --> 00:28:31,366
即使是那種情況

456
00:28:31,366 --> 00:28:33,599
如果要用 Continued Background

457
00:28:33,599 --> 00:28:37,799
Continued Processing Task

458
00:28:37,799 --> 00:28:45,400
如果要用它的話，就必須增加進度的值

459
00:28:45,400 --> 00:28:49,599
得下點工夫，避免被系統停掉才行

460
00:28:52,900 --> 00:28:55,066
驗證後發現的第二件事

461
00:28:56,366 --> 00:29:00,500
這個嘛，我記得其他的 background task 好像也是一樣的

462
00:29:00,500 --> 00:29:02,400
它在模擬器上是無法運作的

463
00:29:02,466 --> 00:29:07,200
再來是這個...

464
00:29:07,200 --> 00:29:12,866
至少在 RC 版，Xcode 的 Swift Language Version

465
00:29:12,866 --> 00:29:15,599
我沒有試 4

466
00:29:15,599 --> 00:29:17,700
5 是沒問題的

467
00:29:17,700 --> 00:29:21,299
但如果設成 6，在 submit 的時候會 crash

468
00:29:21,299 --> 00:29:23,900
我們確認到了這個問題

469
00:29:23,966 --> 00:29:29,099
我已經姑且回報了 bug report

470
00:29:31,000 --> 00:29:37,599
還有，`BGContinuedProcessingTask`...

471
00:29:37,599 --> 00:29:40,700
剛才那個 UI

472
00:29:40,700 --> 00:29:43,766
我們發現，一個 app 似乎只能有一個

473
00:29:43,799 --> 00:29:49,700
就算 submit 了第二個，第二個也無法啟動

474
00:29:49,700 --> 00:29:53,966
沒辦法同時並行兩三個

475
00:29:53,966 --> 00:30:00,200
這個...我猜，說不定是一台裝置只能有一個

476
00:30:00,266 --> 00:30:02,900
至於能不能跨 App

477
00:30:02,900 --> 00:30:05,566
是一個 App 只能一個呢？

478
00:30:05,566 --> 00:30:07,566
還是一台裝置只能一個？

479
00:30:07,566 --> 00:30:08,400
也許是後者吧

480
00:30:08,400 --> 00:30:10,266
這部分我們還沒搞清楚

481
00:30:13,500 --> 00:30:14,500
還有這個...

482
00:30:16,099 --> 00:30:17,599
Picture In Picture 說不定

483
00:30:17,599 --> 00:30:19,566
也是一樣的

484
00:30:19,599 --> 00:30:23,000
就是在系統本身資源受限的狀態下

485
00:30:23,000 --> 00:30:26,400
它會很容易被中斷

486
00:30:31,299 --> 00:30:32,700
這個嘛...

487
00:30:32,700 --> 00:30:34,700
不知道是不是只有

488
00:30:34,700 --> 00:30:37,566
我的驗證裝置才會這樣

489
00:30:37,566 --> 00:30:39,200
但至少我用來驗證的裝置

490
00:30:39,200 --> 00:30:41,500
升級到 iOS 26...

491
00:30:41,500 --> 00:30:45,766
我有兩台裝置升級了

492
00:30:45,799 --> 00:30:47,966
那兩台裝置

493
00:30:47,966 --> 00:30:51,599
自從升到正式版之後

494
00:30:51,599 --> 00:30:53,400
BGContinuedProcessingTask

495
00:30:53,400 --> 00:30:56,166
就完全無法啟動了

496
00:30:57,666 --> 00:31:00,400
我現在有三台 iOS26 的裝置

497
00:31:00,400 --> 00:31:02,500
其中一台還沒升到正式版

498
00:31:02,500 --> 00:31:04,400
剛好忘記升級了

499
00:31:04,400 --> 00:31:05,766
所以還沒升

500
00:31:05,766 --> 00:31:08,599
那台上面是會動的

501
00:31:08,666 --> 00:31:10,666
但升到正式版的就動不了

502
00:31:10,666 --> 00:31:12,466
這點讓我很困擾

503
00:31:12,466 --> 00:31:14,200
我已經在 Developer Forum

504
00:31:14,200 --> 00:31:15,400
問了很多問題

505
00:31:16,700 --> 00:31:19,400
不過，Apple 的工程師是說

506
00:31:19,400 --> 00:31:22,299
「好像是會動的」

507
00:31:22,366 --> 00:31:23,866
所以我把 error log 寄過去

508
00:31:23,866 --> 00:31:28,200
請他們幫我調查了

509
00:31:32,466 --> 00:31:35,400
為了驗證而寫的程式碼

510
00:31:35,400 --> 00:31:38,000
我也公開在 GitHub 上了

511
00:31:38,000 --> 00:31:42,200
有興趣的人之後可以看看

512
00:31:47,366 --> 00:31:50,400
關於「如果要把這功能加進 Mitene 的上傳」...

513
00:31:50,466 --> 00:31:54,700
我也大概試著做了一下

514
00:31:54,700 --> 00:31:57,799
還沒決定要不要真的採用

515
00:31:57,799 --> 00:32:00,799
如果要加進 Mitene 的上傳

516
00:32:00,866 --> 00:32:03,200
那當然

517
00:32:03,266 --> 00:32:05,299
如果是 iOS 26

518
00:32:05,299 --> 00:32:07,466
就會想用 `BGContinuedProcessingTask`

519
00:32:07,466 --> 00:32:08,666
對吧？

520
00:32:08,666 --> 00:32:10,766
我是這麼想的

521
00:32:12,566 --> 00:32:14,400
好，因為這個影片也...

522
00:32:14,466 --> 00:32:16,566
大家可能也看不懂在幹嘛

523
00:32:16,566 --> 00:32:20,000
總之我把「試做看看」的影片

524
00:32:20,000 --> 00:32:22,000
貼在簡報裡了

525
00:32:22,000 --> 00:32:23,099
就是這樣

526
00:32:28,366 --> 00:32:30,966
最後是總結

527
00:32:31,000 --> 00:32:35,200
我憑我的感覺做了一個比較表

528
00:32:35,200 --> 00:32:37,400
大概是這樣

529
00:32:37,400 --> 00:32:39,599
實作的難易度

530
00:32:39,599 --> 00:32:44,700
PIP 的實作我還是覺得有點難

531
00:32:44,766 --> 00:32:48,200
但 `ContinuedProcessingTask` 的實作就沒那麼難

532
00:32:48,200 --> 00:32:50,500
實作本身不難

533
00:32:50,500 --> 00:32:53,599
鎖定時也能運作

534
00:32:53,599 --> 00:32:54,799
這點很不錯

535
00:32:54,799 --> 00:32:59,299
UI 的自由度，因為基本上是統一的規格

536
00:32:59,299 --> 00:33:01,400
所以沒什麼自由度可言

537
00:33:01,400 --> 00:33:05,200
但基本上鎖定時也能上傳

538
00:33:05,266 --> 00:33:06,466
這點很棒

539
00:33:06,466 --> 00:33:12,200
所以等 Xcode 26 支援了之後，想來試試看

540
00:33:12,200 --> 00:33:16,400
總結大概也是這樣

541
00:33:16,400 --> 00:33:18,900
目前是透過 Picture In Picture

542
00:33:18,900 --> 00:33:22,366
讓 iOS App 也能做到背景上傳

543
00:33:22,366 --> 00:33:23,700
這是一點

544
00:33:23,700 --> 00:33:26,599
但鎖定時會停止

545
00:33:26,599 --> 00:33:31,000
而 iOS 26 的 `BGContinuedProcessingTask`

546
00:33:31,000 --> 00:33:34,599
讓我們知道，鎖定時似乎也能上傳了

547
00:33:38,700 --> 00:33:41,400
我的分享差不多到這裡結束了

548
00:33:41,400 --> 00:33:44,866
Mitene 正在招募工程師

549
00:33:44,866 --> 00:33:46,866
如果大家有興趣的話

550
00:33:46,900 --> 00:33:51,400
歡迎來應徵

551
00:33:52,566 --> 00:33:56,200
感謝各位的聆聽

552
00:34:00,599 --> 00:34:01,900
謝謝您的發表

553
00:34:02,000 --> 00:34:04,166
接下來是 Q&A 時間

554
00:34:04,299 --> 00:34:07,599
有任何評論或問題的聽眾，請舉手示意

555
00:34:12,599 --> 00:34:14,400
稍後麥克風會傳過去，請您稍等

556
00:34:15,500 --> 00:34:17,699
謝謝您的分享

557
00:34:17,699 --> 00:34:18,800
內容非常有參考價值

558
00:34:18,900 --> 00:34:20,099
剛才您提到

559
00:34:20,199 --> 00:34:24,066
如果是 iOS 26 之後的版本

560
00:34:24,066 --> 00:34:26,800
用官方的 API 應該是比較好的

561
00:34:26,800 --> 00:34:29,599
但根據 app 實際的使用情況

562
00:34:29,599 --> 00:34:31,699
iOS 26 現在的佔比還很低

563
00:34:31,699 --> 00:34:33,800
所以之前的版本...

564
00:34:33,800 --> 00:34:36,599
我忘記版本號了

565
00:34:36,599 --> 00:34:39,099
在 26 以前的版本

566
00:34:39,099 --> 00:34:42,266
我就在想是不是只能用 PiP 了

567
00:34:42,266 --> 00:34:45,666
看了您的範例程式碼

568
00:34:45,666 --> 00:34:47,599
我覺得好像做得出來

569
00:34:47,599 --> 00:34:51,866
但我注意到一點，您寫了「專利申請中」

570
00:34:51,866 --> 00:34:54,199
我就在想，如果用了那個，會不會被罵

571
00:34:54,199 --> 00:35:00,166
想請教您，在方便透露的範圍內，專利的範圍大概是到哪裡？

572
00:35:00,166 --> 00:35:02,300
好的，謝謝您的提問

573
00:35:02,300 --> 00:35:06,166
關於專利，這個嘛...

574
00:35:06,199 --> 00:35:11,500
該怎麼說呢，首先，申請專利的背景是

575
00:35:11,500 --> 00:35:14,699
我在 mixi 工作

576
00:35:14,699 --> 00:35:19,366
mixi 本來就傾向把各種功能拿去申請專利

577
00:35:19,366 --> 00:35:21,666
公司有這樣的活動

578
00:35:21,699 --> 00:35:22,766
作為其中的一環

579
00:35:22,800 --> 00:35:26,400
高層...應該說部長

580
00:35:26,400 --> 00:35:28,099
也說「這個功能是不是該去申請專利」

581
00:35:28,166 --> 00:35:28,900
雖然是被這樣提醒

582
00:35:28,900 --> 00:35:30,800
才去做的

583
00:35:30,800 --> 00:35:32,966
總之我們就申請了

584
00:35:33,000 --> 00:35:34,400
至於申請的內容

585
00:35:34,400 --> 00:35:39,199
我聽說專利在提出申請後

586
00:35:39,266 --> 00:35:42,366
一年半就會公開

587
00:35:42,400 --> 00:35:45,400
我記得我們是去年 8 月還 9 月提的

588
00:35:45,466 --> 00:35:47,099
從那時算起一年半

589
00:35:47,099 --> 00:35:53,300
大概明年 4 月左右應該就能看到了

590
00:35:53,300 --> 00:35:57,099
詳細內容可能要麻煩您到時去確認

591
00:35:57,099 --> 00:36:00,900
一方面是請您屆時去確認詳細內容

592
00:36:00,966 --> 00:36:03,199
另一方面，由我來隨便亂講，可能也會被罵

593
00:36:03,199 --> 00:36:06,966
所以如果您真的很在意，也許直接詢問 mixi 公司會比較好

594
00:36:06,966 --> 00:36:07,366
不好意思

595
00:36:07,366 --> 00:36:11,066
不好意思

596
00:36:19,466 --> 00:36:20,599
謝謝您的提問

597
00:36:20,800 --> 00:36:22,666
還有其他評論或問題的聽眾嗎？

598
00:36:22,699 --> 00:36:23,966
請舉手

599
00:36:27,400 --> 00:36:31,066
我拿麥克風過去，請稍等

600
00:36:34,599 --> 00:36:36,800
一個是單純關於剛才那件事

601
00:36:36,800 --> 00:36:39,000
專利...這裡有很多專家

602
00:36:39,000 --> 00:36:43,000
如果在這裡細談，大概會牽扯出很多權利問題

603
00:36:43,000 --> 00:36:45,300
（您那樣回答）真是太好了，這是我的感想

604
00:36:45,300 --> 00:36:49,266
另外是一個單純的技術性問題

605
00:36:49,266 --> 00:36:51,400
剛才的 Picture In Picture

606
00:36:51,400 --> 00:36:54,099
是被判定為正在播放影片

607
00:36:54,099 --> 00:36:57,666
所以您有設定了 audio category 對吧

608
00:36:57,666 --> 00:37:00,000
請問，舉例來說，如果用戶

609
00:37:00,000 --> 00:37:03,800
正在用 Apple Music 播放音樂時

610
00:37:03,800 --> 00:37:08,966
在 audio 方面不會有衝突嗎？

611
00:37:09,000 --> 00:37:11,000
像是音樂播放被中斷之類的

612
00:37:11,000 --> 00:37:11,766
是的是的

613
00:37:11,766 --> 00:37:13,000
沒有發生嗎？

614
00:37:13,066 --> 00:37:14,900
謝謝您的提問

615
00:37:14,900 --> 00:37:17,099
該說是個好問題嗎...

616
00:37:17,099 --> 00:37:22,199
這正是我們在發布時修正過的地方

617
00:37:22,199 --> 00:37:25,099
確實如您所說

618
00:37:25,099 --> 00:37:27,300
它是會衝突的

619
00:37:27,300 --> 00:37:31,699
App...我們一開始發布這個功能時

620
00:37:31,699 --> 00:37:33,866
App 一啟動，就不管三七二十一

621
00:37:33,866 --> 00:37:35,800
想說「因為有可能會用到 Picture In Picture」

622
00:37:35,800 --> 00:37:37,766
就設定了剛才提到的 playback

623
00:37:37,800 --> 00:37:40,400
但如果那麼做，就會像您說的

624
00:37:40,400 --> 00:37:42,900
Apple Music 的音樂就會被中斷

625
00:37:42,900 --> 00:37:45,900
所以我們改成限定在「開始上傳時」

626
00:37:45,900 --> 00:37:50,199
才去做 audio session 的設定

627
00:37:50,199 --> 00:37:53,166
我們盡可能把（設定的）範圍縮到最小

628
00:37:53,166 --> 00:37:58,166
雖然下工夫讓音樂不會意外被中斷

629
00:37:58,166 --> 00:38:03,900
但確實還是存在會互相競爭的這個問題

630
00:38:05,566 --> 00:38:06,666
了解了，謝謝您

631
00:38:06,666 --> 00:38:07,300
謝謝

632
00:38:07,699 --> 00:38:10,500
感謝您的提問

633
00:38:10,500 --> 00:38:12,900
還有其他評論或問題的聽眾嗎？

634
00:38:12,900 --> 00:38:14,900
請舉手

635
00:38:22,000 --> 00:38:23,800
還有沒有其他人呢？

636
00:38:30,566 --> 00:38:32,366
時間差不多到了

637
00:38:32,366 --> 00:38:33,699
我們的 Q&A 時間到此結束

638
00:38:34,199 --> 00:38:36,699
接下來是 1 分鐘的回饋時間

639
00:38:36,766 --> 00:38:40,466
1 分鐘的回饋時間

640
00:38:41,199 --> 00:38:47,433
翻譯：吳　俊諺
校對：Lihsuan Chen

